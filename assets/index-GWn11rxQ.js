import{aj as j,x as T,y as k,B as g,v as J,R as le,I as P,J as Q,_ as te,r as w,O as N,j as re,E as ae,ap as ie,M as ue,F as ce,L as v,$ as D,G as p,u as _,k as de,n as me,af as fe}from"./vue-Bp-VKo72.js";import{c as ne,E as oe,b as Z,d as ve,u as pe,e as ge,f as he,g as ye}from"./index-BEcxWQo9.js";import{E as we}from"./index-KHvekKY5.js";import{E as _e,a as Ee}from"./index-DQNWtGWz.js";import{E as ke}from"./index-CePrSitK.js";import{E as be}from"./index-C5DVn9In.js";import{E as Ce}from"./index-DXyvSvzW.js";import"./index-B1yYrzCp.js";import"./isEqual-DDMOfOHw.js";const Ve={style:{"vertical-align":"-0.15em",fill:"currentcolor"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Te(e,t){return k(),T("svg",Ve,t[0]||(t[0]=[g("path",{fill:"currentColor",d:"M224 448a32 32 0 0 0-32 32v384a32 32 0 0 0 32 32h576a32 32 0 0 0 32-32V480a32 32 0 0 0-32-32zm0-64h576a96 96 0 0 1 96 96v384a96 96 0 0 1-96 96H224a96 96 0 0 1-96-96V480a96 96 0 0 1 96-96"},null,-1),g("path",{fill:"currentColor",d:"M512 544a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V576a32 32 0 0 1 32-32m192-160v-64a192 192 0 1 0-384 0v64zM512 64a256 256 0 0 1 256 256v128H256V320A256 256 0 0 1 512 64"},null,-1)]))}const Se=j({name:"ep-lock",render:Te}),Me={style:{"vertical-align":"-0.15em",fill:"currentcolor"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function Re(e,t){return k(),T("svg",Me,t[0]||(t[0]=[g("path",{fill:"currentColor",d:"M512 512a192 192 0 1 0 0-384a192 192 0 0 0 0 384m0 64a256 256 0 1 1 0-512a256 256 0 0 1 0 512m320 320v-96a96 96 0 0 0-96-96H288a96 96 0 0 0-96 96v96a32 32 0 1 1-64 0v-96a160 160 0 0 1 160-160h448a160 160 0 0 1 160 160v96a32 32 0 1 1-64 0"},null,-1)]))}const Be=j({name:"ep-user",render:Re}),Ie={style:{"vertical-align":"-0.15em",fill:"currentcolor"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function $e(e,t){return k(),T("svg",Ie,t[0]||(t[0]=[g("path",{fill:"currentColor",d:"m759.936 805.248l-90.944-91.008A254.9 254.9 0 0 1 512 768a254.9 254.9 0 0 1-156.992-53.76l-90.944 91.008A382.46 382.46 0 0 0 512 896c94.528 0 181.12-34.176 247.936-90.752m45.312-45.312A382.46 382.46 0 0 0 896 512c0-94.528-34.176-181.12-90.752-247.936l-91.008 90.944C747.904 398.4 768 452.864 768 512s-20.096 113.6-53.76 156.992zm-45.312-541.184A382.46 382.46 0 0 0 512 128c-94.528 0-181.12 34.176-247.936 90.752l90.944 91.008A254.9 254.9 0 0 1 512 256c59.136 0 113.6 20.096 156.992 53.76zm-541.184 45.312A382.46 382.46 0 0 0 128 512c0 94.528 34.176 181.12 90.752 247.936l91.008-90.944A254.9 254.9 0 0 1 256 512c0-59.136 20.096-113.6 53.76-156.992zm417.28 394.496a194.6 194.6 0 0 0 22.528-22.528C686.912 602.56 704 559.232 704 512a191.23 191.23 0 0 0-67.968-146.56A191.3 191.3 0 0 0 512 320a191.23 191.23 0 0 0-146.56 67.968C337.088 421.44 320 464.768 320 512a191.23 191.23 0 0 0 67.968 146.56C421.44 686.912 464.768 704 512 704c47.296 0 90.56-17.088 124.032-45.44M512 960a448 448 0 1 1 0-896a448 448 0 0 1 0 896"},null,-1)]))}const Le=j({name:"ep-help",render:$e}),Ae={style:{"vertical-align":"-0.15em",fill:"currentcolor"},viewBox:"0 0 1024 1024",width:"1em",height:"1em"};function De(e,t){return k(),T("svg",Ae,t[0]||(t[0]=[g("path",{fill:"currentColor",d:"M406.656 706.944L195.84 496.256a32 32 0 1 0-45.248 45.248l256 256l512-512a32 32 0 0 0-45.248-45.248L406.592 706.944z"},null,-1)]))}const Fe=j({name:"ep-check",render:De}),Ne=""+new URL("1-EumNmZkV.jpg",import.meta.url).href,Ue=""+new URL("2-D9DNpwaZ.jpg",import.meta.url).href,je=""+new URL("3-_rRQx6ox.jpg",import.meta.url).href,ze=""+new URL("4-BnIkuOXy.jpg",import.meta.url).href,Xe=""+new URL("5-BV1RcnDC.jpg",import.meta.url).href,qe=""+new URL("6-CSDynz2s.jpg",import.meta.url).href,L=Math.PI;function K(e,t){return e+t}function xe(e){return e*e}function ee(e,t,o,n,c,a){e.beginPath(),e.moveTo(t,o),e.arc(t+n/2,o-c+2,c,.72*L,2.26*L),e.lineTo(t+n,o),e.arc(t+n+c-2,o+n/2,c,1.21*L,2.78*L),e.lineTo(t+n,o+n),e.lineTo(t,o+n),e.arc(t+c-2,o+n/2,c+.4,2.76*L,1.24*L,!0),e.lineTo(t,o),e.lineWidth=2,e.fillStyle="rgba(255, 255, 255, 0.7)",e.strokeStyle="rgba(255, 255, 255, 0.7)",e.stroke(),e[a](),e.globalCompositeOperation="destination-over"}function Ye(e,t){const o=document.createElement("img");return o.crossOrigin="Anonymous",o.onload=t,o.onerror=()=>{o.src=G(e)},o.src=G(e),o}function U(e,t){return Math.round(Math.random()*(t-e)+e)}function G(e){const t=e.length;return t>0?e[U(0,t-1)]:"https://picsum.photos/300/150?image="+U(0,1084)}function Oe(e,t,o={leading:!0,trailing:!0}){const{leading:n,trailing:c,resultCallback:a}=o;let i=0,h=null;const E=function(...m){return new Promise((s,f)=>{const r=new Date().getTime();!i&&!n&&(i=r);const d=t-(r-i);if(d<=0){h&&(clearTimeout(h),h=null);const l=e.apply(this,m);a&&a(l),s(l),i=r;return}c&&!h&&(h=setTimeout(()=>{h=null,i=n?new Date().getTime():0;const l=e.apply(this,m);a&&a(l),s(l)},d))})};return E.cancel=function(){h&&clearTimeout(h),h=null,i=0},E}function He(){const e=N({x:0,y:0}),t=w(!1),o=w(!1),n=w(0),c=w([]);return{origin:e,success:t,isMouseDown:o,timestamp:n,trail:c,start:m=>{t.value||(m instanceof MouseEvent?(e.x=m.clientX,e.y=m.clientY):(e.x=m.changedTouches[0].pageX,e.y=m.changedTouches[0].pageY),o.value=!0,n.value=Date.now())},move:(m,s,f)=>{if(!o.value)return!1;let r=0,d=0;if(s instanceof MouseEvent?(r=s.clientX-e.x,d=s.clientY-e.y):(r=s.changedTouches[0].pageX-e.x,d=s.changedTouches[0].pageY-e.y),r<0||r+38>=m)return!1;f(r),c.value.push(d)},end:(m,s)=>{if(!o.value||(o.value=!1,(m instanceof MouseEvent?m.clientX:m.changedTouches[0].pageX)===e.x))return!1;n.value=Date.now()-n.value,s(n.value)},verify:(m,s,f)=>{const r=c.value,d=r.reduce(K)/r.length,l=r.map(b=>b-d),u=Math.sqrt(l.map(xe).reduce(K)/r.length),S=parseInt(m);return f=f<=1?1:f>10?10:f,{spliced:Math.abs(S-s)<=f,TuringTest:d!==u}}}}var Pe=(e,t)=>{const o=e.__vccOpts||e;for(const[n,c]of t)o[n]=c;return o};const Qe=J({name:"SlideVerify",props:{l:{type:Number,default:42},r:{type:Number,default:10},w:{type:Number,default:310},h:{type:Number,default:155},sliderText:{type:String,default:"Slide filled right"},accuracy:{type:Number,default:5},show:{type:Boolean,default:!0},imgs:{type:Array,default:()=>[]},interval:{type:Number,default:50}},emits:["success","again","fail","refresh"],setup(e,{emit:t}){const{imgs:o,l:n,r:c,w:a,h:i,accuracy:h,interval:E}=e,m=w(!0),s=w(0),f=w(0),r=N({containerActive:!1,containerSuccess:!1,containerFail:!1}),d=N({iconCls:"arrow-right",width:"0",left:"0"}),l=w(),u=w(),S=w(),b=w();let R;const{success:M,start:F,move:z,end:X,verify:q}=He(),A=()=>{var y,V;M.value=!1,r.containerActive=!1,r.containerSuccess=!1,r.containerFail=!1,d.iconCls="arrow-right",d.left="0",d.width="0",l.value.style.left="0",(y=b.value)==null||y.clearRect(0,0,a,i),(V=u.value)==null||V.clearRect(0,0,a,i),l.value.width=a,R.src=G(o)},x=()=>{A(),t("refresh")};function Y(y){d.left=y+"px";let V=(a-40-20)/(a-40)*y;l.value.style.left=V+"px",r.containerActive=!0,d.width=y+"px"}function C(y){const{spliced:V,TuringTest:B}=q(l.value.style.left,s.value,h);if(V){if(h===-1){r.containerSuccess=!0,d.iconCls="success",M.value=!0,t("success",y);return}B?(r.containerSuccess=!0,d.iconCls="success",M.value=!0,t("success",y)):(r.containerFail=!0,d.iconCls="fail",t("again"))}else r.containerFail=!0,d.iconCls="fail",t("fail"),setTimeout(()=>{A()},1e3)}const O=Oe(y=>{z(a,y,Y)},E),H=y=>{X(y,C)};return re(()=>{var y,V;const B=(y=S.value)==null?void 0:y.getContext("2d"),I=(V=l.value)==null?void 0:V.getContext("2d",{willReadFrequently:!0});b.value=B,u.value=I,R=Ye(o,()=>{m.value=!1;const $=n+c*2+3;if(s.value=U($+10,a-($+10)),f.value=U(10+c*2,i-($+10)),B&&I){ee(B,s.value,f.value,n,c,"fill"),ee(I,s.value,f.value,n,c,"clip"),B.drawImage(R,0,0,a,i),I.drawImage(R,0,0,a,i);const W=f.value-c*2-1,se=I.getImageData(s.value,W,$,$);l.value.width=$,I.putImageData(se,0,W)}}),document.addEventListener("mousemove",O),document.addEventListener("mouseup",H)}),ae(()=>{document.removeEventListener("mousemove",O),document.removeEventListener("mouseup",H)}),{block:l,canvas:S,loadBlock:m,containerCls:r,sliderBox:d,refresh:x,sliderDown:F,touchStartEvent:F,touchMoveEvent:O,touchEndEvent:H}}}),Ze=["width","height"],Ge=["width","height"],Je={class:"slide-verify-slider-text"};function We(e,t,o,n,c,a){return k(),T("div",{id:"slideVerify",class:"slide-verify",style:Q({width:e.w+"px"}),onselectstart:"return false;"},[g("div",{class:P({"slider-verify-loading":e.loadBlock})},null,2),g("canvas",{ref:"canvas",width:e.w,height:e.h},null,8,Ze),e.show?(k(),T("div",{key:0,class:"slide-verify-refresh-icon",onClick:t[0]||(t[0]=(...i)=>e.refresh&&e.refresh(...i))},t[5]||(t[5]=[g("i",{class:"iconfont icon-refresh"},null,-1)]))):le("",!0),g("canvas",{ref:"block",width:e.w,height:e.h,class:"slide-verify-block"},null,8,Ge),g("div",{class:P(["slide-verify-slider",{"container-active":e.containerCls.containerActive,"container-success":e.containerCls.containerSuccess,"container-fail":e.containerCls.containerFail}])},[g("div",{class:"slide-verify-slider-mask",style:Q({width:e.sliderBox.width})},[g("div",{class:"slide-verify-slider-mask-item",style:Q({left:e.sliderBox.left}),onMousedown:t[1]||(t[1]=(...i)=>e.sliderDown&&e.sliderDown(...i)),onTouchstart:t[2]||(t[2]=(...i)=>e.touchStartEvent&&e.touchStartEvent(...i)),onTouchmove:t[3]||(t[3]=(...i)=>e.touchMoveEvent&&e.touchMoveEvent(...i)),onTouchend:t[4]||(t[4]=(...i)=>e.touchEndEvent&&e.touchEndEvent(...i))},[g("i",{class:P(["slide-verify-slider-mask-item-icon","iconfont","icon-".concat(e.sliderBox.iconCls)])},null,2)],36)],4),g("span",Je,te(e.sliderText),1)],2)],4)}var Ke=Pe(Qe,[["render",We],["__scopeId","data-v-3f647794"]]);const et={key:0,class:"verify-success"},tt=J({__name:"login-verify",props:{modelValue:{type:Boolean},modelModifiers:{}},emits:["update:modelValue"],setup(e,{expose:t}){const o=[Ne,Ue,je,ze,Xe,qe],n=w(),c=ie(e,"modelValue"),a=w(!1);function i(){var s;(s=n.value)==null||s.refresh(),me(()=>{a.value=!0})}function h(){var s;Z.warning("系统检测到异常，请重试！"),(s=n.value)==null||s.refresh()}function E(s){c.value=!0,a.value=!1}function m(){Z.error("验证失败，请重试！")}return t({visible:a}),(s,f)=>{const r=Fe,d=ne,l=Le,u=oe,S=we;return k(),T(ue,null,[c.value?(k(),T("div",et,[v(d,null,{default:p(()=>[v(r)]),_:1}),f[1]||(f[1]=D(" 验证通过 "))])):(k(),ce(u,{key:1,type:"info",long:"",onClick:i},{icon:p(()=>[v(l)]),default:p(()=>[f[2]||(f[2]=D(" 点击按钮完成验证 "))]),_:1})),v(S,{modelValue:_(a),"onUpdate:modelValue":f[0]||(f[0]=b=>de(a)?a.value=b:null),width:"460px"},{default:p(()=>[v(_(Ke),{ref_key:"block",ref:n,"slider-text":"请向右滑动滑块完成验证",w:420,h:220,imgs:o,show:!1,class:"slide-verify-custom",onAgain:h,onSuccess:E,onFail:m},null,512)]),_:1},8,["modelValue"])],64)}}}),nt={class:"login-container"},ot={class:"login-wrapper"},st={class:"login-form"},lt={class:"login-title"},pt=J({__name:"index",setup(e){const t={username:[{required:!0,message:"请输入用户名"},{min:3,message:"用户名至少为 3 个字符"},{max:12,message:"用户名最多为 12 个字符"}],password:[{required:!0,message:"请输入密码"},{min:5,message:"密码至少为 5 个字符"},{max:18,message:"密码最多为 18 个字符"}]},o=ve("app-login",{username:"admin",password:"admin",remember:!0}),n=N({username:o.value.username,password:o.value.password,remember:o.value.remember,verify:!1}),c=pe(),a=ge(),{currentRoute:i,push:h}=fe(),E=w(),m=w(),s=w(!1);function f(){const{redirect:l,...u}=i.value.query;h({path:l||"/",query:{...u}})}async function r(){s.value=!0;try{await a.login(n),f(),Z.success("欢迎使用！");const l=n.remember;o.value.username=l?n.username:"",o.value.password=l?n.password:"",o.value.remember=l}catch(l){console.error(l)}s.value=!1}function d(){var l;(l=E.value)==null||l.validate(async u=>{if(u){if(!n.verify){m.value.visible=!0;return}r()}})}return(l,u)=>{const S=Be,b=ne,R=ke,M=_e,F=Se,z=Ce,X=he,q=be,A=oe,x=ye,Y=Ee;return k(),T("div",nt,[g("div",ot,[u[7]||(u[7]=g("div",{class:"login-banner"},null,-1)),g("div",st,[g("div",lt," 欢迎登录 "+te(_(c).title),1),v(Y,{ref_key:"formRef",ref:E,"hide-required-asterisk":"",model:_(n),rules:t,onSubmit:d},{default:p(()=>[v(M,{prop:"username"},{default:p(()=>[v(R,{modelValue:_(n).username,"onUpdate:modelValue":u[0]||(u[0]=C=>_(n).username=C),modelModifiers:{trim:!0},"validate-event":!1,placeholder:"请输入账号"},{prefix:p(()=>[v(b,null,{default:p(()=>[v(S)]),_:1})]),_:1},8,["modelValue"])]),_:1}),v(M,{prop:"password"},{default:p(()=>[v(R,{modelValue:_(n).password,"onUpdate:modelValue":u[1]||(u[1]=C=>_(n).password=C),modelModifiers:{trim:!0},"validate-event":!1,type:"password","show-password":"",placeholder:"请输入密码"},{prefix:p(()=>[v(b,null,{default:p(()=>[v(F)]),_:1})]),_:1},8,["modelValue"])]),_:1}),v(M,{prop:"verify"},{default:p(()=>[v(tt,{ref_key:"verifyRef",ref:m,modelValue:_(n).verify,"onUpdate:modelValue":u[2]||(u[2]=C=>_(n).verify=C)},null,8,["modelValue"])]),_:1}),v(M,null,{default:p(()=>[v(q,{justify:"space-between",style:{width:"100%"}},{default:p(()=>[v(z,{modelValue:_(n).remember,"onUpdate:modelValue":u[3]||(u[3]=C=>_(n).remember=C),label:"记住密码"},null,8,["modelValue"]),v(X,{type:"primary",underline:!1},{default:p(()=>u[4]||(u[4]=[D(" 忘记密码 ")])),_:1})]),_:1})]),_:1}),v(x,{direction:"vertical",fill:"",style:{width:"100%"}},{default:p(()=>[v(A,{long:"",type:"primary",loading:_(s),onClick:d},{default:p(()=>u[5]||(u[5]=[D(" 登录 ")])),_:1},8,["loading"]),v(A,{long:"",text:""},{default:p(()=>u[6]||(u[6]=[D(" 注册账号 ")])),_:1})]),_:1})]),_:1},8,["model"])])])])}}});export{pt as default};
